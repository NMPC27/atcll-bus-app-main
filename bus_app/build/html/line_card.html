<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LineCard &mdash; BusAppDoc 1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="LinesTable" href="lines_table.html" />
    <link rel="prev" title="Lines" href="lines.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> BusAppDoc
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="app.html">App</a></li>
<li class="toctree-l1"><a class="reference internal" href="appjson.html">App json</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="screens.html">Screens</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="map_screen.html">MapScreen</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="lines.html">Lines</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">LineCard</a></li>
<li class="toctree-l3"><a class="reference internal" href="lines_table.html">LinesTable</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bus_schedule.html">BusSchedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="live_traffic.html">LiveTraffic</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html">About</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Scripts</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BusAppDoc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="screens.html">Screens</a> &raquo;</li>
          <li><a href="lines.html">Lines</a> &raquo;</li>
      <li>LineCard</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/line_card.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="linecard">
<h1>LineCard<a class="headerlink" href="#linecard" title="Permalink to this headline"></a></h1>
<p>This component is used to display the card that contains the map with the stops and buses doing a certain line.</p>
<p>In the state of this class we have the following variables:</p>
<ul class="simple">
<li><p>user: it’s a variable containing the latitude and longitude of the user.</p></li>
</ul>
<p>On load ( componentDidMount ) of this class we start looking for the user’s location and update the state with it.
The method watchPositionAsync subscribes to location updates from the device therefore the location will be updated in real time.
(see <a class="reference external" href="https://docs.expo.dev/versions/latest/sdk/location/#locationwatchpositionasyncoptions-callback">https://docs.expo.dev/versions/latest/sdk/location/#locationwatchpositionasyncoptions-callback</a> )</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">componentDidMount</span><span class="p">(){</span><span class="w"></span>
<span class="w">    </span><span class="nx">Location</span><span class="p">.</span><span class="nx">watchPositionAsync</span><span class="p">({</span><span class="nx">enableHighAccuracy</span><span class="o">:</span><span class="kc">true</span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nx">location</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">user</span><span class="o">:</span><span class="p">{</span><span class="nx">lat</span><span class="o">:</span><span class="w"> </span><span class="nx">location</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">latitude</span><span class="w"> </span><span class="p">,</span><span class="nx">lon</span><span class="o">:</span><span class="w"> </span><span class="nx">location</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">longitude</span><span class="p">}});</span><span class="w"></span>
<span class="w">    </span><span class="p">});</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>In the return of the render method we use the Card component from the react native paper library (see <a class="reference external" href="https://callstack.github.io/react-native-paper/card.html">https://callstack.github.io/react-native-paper/card.html</a> for more information) as well as MapView component to display the map and the several markers, like user,buses and stops.</p>
<p>MapView is used to display the map.
(see <a class="reference external" href="https://github.com/react-native-maps/react-native-maps/blob/master/docs/mapview.md">https://github.com/react-native-maps/react-native-maps/blob/master/docs/mapview.md</a> )
MapView we use the following atributes:</p>
<ul class="simple">
<li><p>ref: need to reference the map to use the animateToRegion method</p></li>
<li><p>style: the style of the map to ocupy most of the card</p></li>
<li><p>customMapStyle: style to simplify the map (remove the points of interest in the map)</p></li>
<li><p>initialRegion: the initial region of the map ( center of Aveiro )</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">MapView</span>
<span class="n">ref</span><span class="o">=</span><span class="p">{(</span><span class="nb">map</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="n">this</span><span class="o">.</span><span class="n">map</span> <span class="o">=</span> <span class="nb">map</span><span class="p">;</span> <span class="p">}}</span>
<span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="n">styles</span><span class="o">.</span><span class="n">map</span><span class="p">}</span>
<span class="n">customMapStyle</span><span class="o">=</span><span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
<span class="n">initialRegion</span><span class="o">=</span><span class="p">{{</span>
    <span class="n">latitude</span><span class="p">:</span> <span class="mf">40.638495</span><span class="p">,</span>
    <span class="n">longitude</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.651443</span><span class="p">,</span>
    <span class="n">latitudeDelta</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span>
    <span class="n">longitudeDelta</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span>
<span class="p">}}</span>
<span class="o">&gt;</span>
<span class="o">...</span>
<span class="o">&lt;/</span><span class="n">MapView</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>MapView.Marker is used to display the markers.
(see <a class="reference external" href="https://github.com/react-native-maps/react-native-maps/blob/master/docs/marker.md">https://github.com/react-native-maps/react-native-maps/blob/master/docs/marker.md</a> )
MapView.Marker we use the following atributes:</p>
<ul class="simple">
<li><p>coordinate: the coordinates of the marker</p></li>
<li><p>title: the title of the marker (on press shows the title)</p></li>
<li><p>image: the image of the marker</p></li>
<li><p><em>key</em>: the key of the marker because we create several markers (warning: if we dont use the key)</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>{ this.state.user.lat !== null ? … : null } is used to show the user location only when its detected.</p>
<p>{ this.state.buses.bus((val, index) =&gt; { return ( … );}) } is used to render all the buses/stops.</p>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">lat</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"></span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">MapView</span><span class="p">.</span><span class="nx">Marker</span><span class="w"> </span><span class="c1">//! marcador do user</span><span class="w"></span>
<span class="w">                </span><span class="nx">coordinate</span><span class="o">=</span><span class="p">{{</span><span class="w"></span>
<span class="w">                </span><span class="nx">latitude</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">lat</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nx">longitude</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">lon</span><span class="w"></span>
<span class="w">                </span><span class="p">}}</span><span class="w"></span>
<span class="w">                </span><span class="nx">title</span><span class="o">=</span><span class="s2">&quot;You are here&quot;</span><span class="w"></span>
<span class="w">                </span><span class="nx">image</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../assets/user.png&#39;</span><span class="p">)}</span><span class="w"></span>
<span class="w">            </span><span class="o">/&gt;</span><span class="w"></span>
<span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">          </span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">lineStops</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">val</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="c1">//! STOP MARKER</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MapView</span><span class="p">.</span><span class="nx">Marker</span><span class="w"></span>
<span class="w">                    </span><span class="nx">coordinate</span><span class="o">=</span><span class="p">{{</span><span class="w"></span>
<span class="w">                    </span><span class="nx">latitude</span><span class="o">:</span><span class="w"> </span><span class="nx">val</span><span class="p">.</span><span class="nx">lat</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nx">longitude</span><span class="o">:</span><span class="nx">val</span><span class="p">.</span><span class="nx">lon</span><span class="w"></span>
<span class="w">                    </span><span class="p">}}</span><span class="w"></span>
<span class="w">                    </span><span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">index</span><span class="p">}</span><span class="w"></span>
<span class="w">                    </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">val</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="w"></span>
<span class="w">                    </span><span class="nx">image</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../assets/stop.png&#39;</span><span class="p">)}</span><span class="w"></span>
<span class="w">                    </span><span class="o">/&gt;</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="p">})}</span><span class="w"></span>

<span class="w">              </span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">buses</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">val</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="c1">//! BUS MARKER</span><span class="w"></span>
<span class="w">                      </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MapView</span><span class="p">.</span><span class="nx">Marker</span><span class="w"></span>
<span class="w">                                </span><span class="nx">coordinate</span><span class="o">=</span><span class="p">{{</span><span class="w"></span>
<span class="w">                                </span><span class="nx">latitude</span><span class="o">:</span><span class="w"> </span><span class="nx">val</span><span class="p">.</span><span class="nx">lat</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nx">longitude</span><span class="o">:</span><span class="nx">val</span><span class="p">.</span><span class="nx">lon</span><span class="w"></span>
<span class="w">                                </span><span class="p">}}</span><span class="w"></span>
<span class="w">                                </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;linha: &quot;</span><span class="o">+</span><span class="nx">val</span><span class="p">.</span><span class="nx">linha</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="nx">image</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../assets/bus.png&#39;</span><span class="p">)}</span><span class="w"></span>
<span class="w">                              </span><span class="o">/&gt;</span><span class="p">);</span><span class="w"></span>
<span class="w">                  </span><span class="p">})}</span><span class="w"></span>
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="lines.html" class="btn btn-neutral float-left" title="Lines" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="lines_table.html" class="btn btn-neutral float-right" title="LinesTable" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, PECI.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>